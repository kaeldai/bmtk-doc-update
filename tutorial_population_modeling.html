<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial 6: Population Level Modeling (with PopNet) &#8212; Brain Modeling Toolkit 1.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=1a8f0775" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=58fbf978"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Additional Tutorials" href="ad_tutorials.html" />
    <link rel="prev" title="Auditory Stimuli Inputs using FilterNet" href="tutorial_auditory_filternet.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
<div style="background-color: #f8f9fa; padding: 10px; text-align: center;">
    <a href="https://alleninstitute.org/">
      <img src="https://alleninstitute.org/wp-content/themes/gmmb-allen/images/allen-logo.svg" alt="Your Image" style="max-height: 80px;">
    </a>
  </div>


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Tutorial-6:-Population-Level-Modeling-(with-PopNet)">
<h1>Tutorial 6: Population Level Modeling (with PopNet)<a class="headerlink" href="#Tutorial-6:-Population-Level-Modeling-(with-PopNet)" title="Link to this heading">¶</a></h1>
<p>In this tutorial we will focus on modeling of populations and population firing rates. This is done with the PopNet simulator application of bmtk which uses <a class="reference external" href="https://github.com/AllenInstitute/dipde">DiPDE</a> engine as a backend. We will first build our networks using the bmtk NetworkBuilder and save them into the SONATA data format. Then we will show how to simulate the firing rates over a given time-source.</p>
<p>Requirements: * BMTK * DiPDE</p>
<section id="1.-Building-the-network">
<h2>1. Building the network<a class="headerlink" href="#1.-Building-the-network" title="Link to this heading">¶</a></h2>
<section id="Converting-existing-networks">
<h3>Converting existing networks<a class="headerlink" href="#Converting-existing-networks" title="Link to this heading">¶</a></h3>
<p>Like BioNet for biophysically detailed modeling, and PointNet with point-based networks, PopNet stores networks in the SONATA data format. PopNet supports simulating networks of individual cells at the population level. First thing you have to do is modify the node-types and edge-types of an existing network to use Population level models (rather than models of individual cells.</p>
<div class="admonition warning">
<p><strong>WARNING</strong> - Converting a network of individual nodes into population of nodes is good for a quick and naive simulation, but for faster and more reliable results it’s best to build a network from scratch (next section).</p>
</div>
<p>Here is the node-types csv file of a network set to work with BioNet</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sources/chapter06/converted_network/V1_node_types_bionet.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>node_type_id</th>
      <th>ei</th>
      <th>morphology_file</th>
      <th>model_processing</th>
      <th>pop_name</th>
      <th>location</th>
      <th>model_template</th>
      <th>model_type</th>
      <th>dynamics_params</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>e</td>
      <td>Scnn1a.swc</td>
      <td>aibs_perisomatic</td>
      <td>Scnn1a</td>
      <td>L4</td>
      <td>ctdb:Biophys1.hoc</td>
      <td>biophysical</td>
      <td>472363762_fit.json</td>
    </tr>
    <tr>
      <th>1</th>
      <td>101</td>
      <td>i</td>
      <td>Pvalb.swc</td>
      <td>aibs_perisomatic</td>
      <td>PV</td>
      <td>L4</td>
      <td>ctdb:Biophys1.hoc</td>
      <td>biophysical</td>
      <td>472912177_fit.json</td>
    </tr>
    <tr>
      <th>2</th>
      <td>102</td>
      <td>e</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIF_exc</td>
      <td>VisL4</td>
      <td>nrn:IntFire1</td>
      <td>point_process</td>
      <td>IntFire1_exc_1.json</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103</td>
      <td>i</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIF_inh</td>
      <td>VisL4</td>
      <td>nrn:IntFire1</td>
      <td>point_process</td>
      <td>IntFire1_inh_1.json</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>vs the equivelent form for PopNet</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sources/chapter06/converted_network/V1_node_types_popnet.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>node_type_id</th>
      <th>ei</th>
      <th>morphology_file</th>
      <th>model_processing</th>
      <th>pop_name</th>
      <th>location</th>
      <th>model_template</th>
      <th>model_type</th>
      <th>dynamics_params</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>e</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Scnn1a</td>
      <td>L4</td>
      <td>dipde:Internal</td>
      <td>population</td>
      <td>472363762_pop.json</td>
    </tr>
    <tr>
      <th>1</th>
      <td>101</td>
      <td>i</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>PV</td>
      <td>L4</td>
      <td>dipde:Internal</td>
      <td>population</td>
      <td>472912177_pop.json</td>
    </tr>
    <tr>
      <th>2</th>
      <td>102</td>
      <td>e</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIF_exc</td>
      <td>VisL4</td>
      <td>dipde:Internal</td>
      <td>population</td>
      <td>IntFire1_exc_pop.json</td>
    </tr>
    <tr>
      <th>3</th>
      <td>103</td>
      <td>i</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LIF_inh</td>
      <td>VisL4</td>
      <td>dipde:Internal</td>
      <td>population</td>
      <td>IntFire1_inh_pop.json</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Some things to note: * <strong>model_type</strong> is now a population for all nodes, rather than individual biophysical/point types * We have set <strong>model_template</strong> to dipde:Internal which will tell the simulator to use special DiPDE model types * We are using new <strong>dynamic_params</strong> files with parameters that have been adjusted to appropiate range for DiPDE models. * <strong>morophology_file</strong> and <strong>model_processing</strong>, which were used to set and processes individual cell morphologies, is no longer
applicable.</p>
<p>We must make similar adjustments to our edge_types.csv files. And finally when we run the simulation we must tell PopNet to cluster nodes together using the <strong>group_by</strong> property</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">popnet</span><span class="o">.</span><span class="n">PopNetwork</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">configure</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;node_type_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Building-a-network">
<h3>Building a network<a class="headerlink" href="#Building-a-network" title="Link to this heading">¶</a></h3>
<p>We will create a network of two populations, one population of excitatory cells and another of inhibitory cells. Then we will save the network into SONATA formated data files.</p>
<p>The first step is to use the NetworkBuilder to instantiate a new network with two populations:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bmtk.builder</span> <span class="kn">import</span> <span class="n">NetworkBuilder</span>


<span class="n">net</span> <span class="o">=</span> <span class="n">NetworkBuilder</span><span class="p">(</span><span class="s1">&#39;V1&#39;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
    <span class="n">pop_name</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">,</span>  <span class="c1"># name of specific population optional</span>
    <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span>  <span class="c1"># Optional</span>
    <span class="n">location</span><span class="o">=</span><span class="s1">&#39;VisL4&#39;</span><span class="p">,</span>  <span class="c1"># Optional</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;population&#39;</span><span class="p">,</span>  <span class="c1"># Required, indicates what types of cells are being model</span>
    <span class="n">model_template</span><span class="o">=</span><span class="s1">&#39;dipde:Internal&#39;</span><span class="p">,</span>  <span class="c1"># Required, instructs what DiPDE objects will be created</span>
    <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;exc_model.json&#39;</span>  <span class="c1"># Required, contains parameters used by DiPDE during initialization of object</span>
<span class="p">)</span>

<span class="n">net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
    <span class="n">pop_name</span><span class="o">=</span><span class="s1">&#39;inhibitory&#39;</span><span class="p">,</span>
    <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;population&#39;</span><span class="p">,</span>
    <span class="n">model_template</span><span class="o">=</span><span class="s1">&#39;dipde:Internal&#39;</span><span class="p">,</span>
    <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;inh_model.json&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we will create connections between the two populations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;i&#39;</span><span class="p">},</span>
    <span class="n">syn_weight</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">nsyns</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">delay</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
    <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;ExcToInh.json&#39;</span>
<span class="p">)</span>

<span class="n">net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;i&#39;</span><span class="p">},</span> <span class="n">target</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ei&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">},</span>
    <span class="n">syn_weight</span><span class="o">=-</span><span class="mf">0.002</span><span class="p">,</span>
    <span class="n">nsyns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">delay</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
    <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;InhToExc.json&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;bmtk.builder.connection_map.ConnectionMap at 0x7f5ea775c940&gt;
</pre></div></div>
</div>
<p>and finally we must build and save the network</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;sim_ch06/network&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="External-Nodes">
<h4>External Nodes<a class="headerlink" href="#External-Nodes" title="Link to this heading">¶</a></h4>
<p>The <em>dipde:Internal</em> nodes we created don’t carry intrinsic firing rates, and instead we will use External Populations to drive the network activity. To do this we will create a separate network of ‘virtual’ populations, or alternativly use model_type=dipde:External, that connect to our excitatory population.</p>
<p>Note: we could add ‘virtual’ populations directly to our V1 network. However creating them as a separate network provides a great advantage if/when we want to replace our external connections with a different model (Or if we want to remove the reccurrent connections and simulation with only feed-foward activity).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_net</span> <span class="o">=</span> <span class="n">NetworkBuilder</span><span class="p">(</span><span class="s1">&#39;LGN&#39;</span><span class="p">)</span>
<span class="n">input_net</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span>
    <span class="n">pop_name</span><span class="o">=</span><span class="s1">&#39;tON&#39;</span><span class="p">,</span>
    <span class="n">ei</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;virtual&#39;</span>
<span class="p">)</span>

<span class="n">input_net</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span>
    <span class="n">target</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">ei</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">),</span>
    <span class="n">syn_weight</span><span class="o">=</span><span class="mf">0.0025</span><span class="p">,</span>
    <span class="n">nsyns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">delay</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
    <span class="n">dynamics_params</span><span class="o">=</span><span class="s1">&#39;input_ExcToExc.json&#39;</span>
<span class="p">)</span>

<span class="n">input_net</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">input_net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;sim_ch06/network&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="2.-Setting-up-the-PopNet-environment">
<h2>2. Setting up the PopNet environment<a class="headerlink" href="#2.-Setting-up-the-PopNet-environment" title="Link to this heading">¶</a></h2>
<p>Before running the simulation we need to set up our simulation environment, inlcuding setting up run-scripts, configuration parameters, and placing our parameter files in their appropiate location. The easiest way to do this is through the command-line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>-m<span class="w"> </span>bmtk.utils.sim_setup<span class="w"> </span>-n<span class="w"> </span>network<span class="w"> </span>--tstop<span class="w"> </span><span class="m">1500</span>.0<span class="w"> </span>popnet<span class="w"> </span>sim_ch06/
</pre></div>
</div>
<p>Which creates initial files to run a 1500 ms simulation using the network files found in our ./network directory.</p>
<section id="Inputs">
<h3>Inputs<a class="headerlink" href="#Inputs" title="Link to this heading">¶</a></h3>
<p>We next need to set the firing rates of the External Population. There are multiple ways to set this value which will be discussed later. The best way is to set the firing rates using a input-rates file for each External Population, we can fetch an existing one using the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sim_ch06
$<span class="w"> </span>wget<span class="w"> </span>https://github.com/AllenInstitute/bmtk/raw/develop/examples/pop_2pops/inputs/external_rates.csv<span class="w"> </span>-O<span class="w"> </span>lgn_rates.csv
</pre></div>
</div>
<p>Then we must open the simulation_config.json file with a text editor and add the lgn_rates.csv file as a part of our inputs:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;inputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;LGN_pop_rates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pop_rates&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;rates&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${BASE_DIR}/lgn_rates.csv&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;node_set&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LGN&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="3.-Running-the-simulation">
<h2>3. Running the simulation<a class="headerlink" href="#3.-Running-the-simulation" title="Link to this heading">¶</a></h2>
<p>The call to sim_setup created a file run_pointnet.py which we can run directly in a command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>run_popnet.py<span class="w"> </span>config.json
</pre></div>
</div>
<p>Or we can run it directly using the following python code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bmtk.simulator</span> <span class="kn">import</span> <span class="n">popnet</span>

<span class="n">configure</span> <span class="o">=</span> <span class="n">popnet</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s1">&#39;sim_ch06/config.json&#39;</span><span class="p">)</span>
<span class="n">configure</span><span class="o">.</span><span class="n">build_env</span><span class="p">()</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">popnet</span><span class="o">.</span><span class="n">PopNetwork</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">configure</span><span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">popnet</span><span class="o">.</span><span class="n">PopSimulator</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">configure</span><span class="p">,</span> <span class="n">network</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2022-08-09 16:50:15,019 [WARNING] Directory /home/ping/bmtk_change/bmtk/docs/tutorial/sim_ch06/output already exists.
2022-08-09 16:50:15,020 [INFO] Created log file
2022-08-09 16:50:15,054 [INFO] Building cells.
2022-08-09 16:50:15,055 [INFO] Building recurrent connections
2022-08-09 16:50:15,059 [INFO] Build virtual cell stimulations for LGN_pop_rates
2022-08-09 16:50:15,078 [INFO] Network created.
2022-08-09 16:50:15,080 [INFO] Running simulation.
2022-08-09 16:50:18,766 [INFO] Finished simulation.
</pre></div></div>
</div>
</section>
<section id="4.-Analyzing-results">
<h2>4. Analyzing results<a class="headerlink" href="#4.-Analyzing-results" title="Link to this heading">¶</a></h2>
<p>As specified in the “output” section of simulation_config.json, the results will be written to ouput/spike_rates.csv. The BMTK analyzer includes code for ploting and analyzing the firing rates of our network:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bmtk.analyzer.firing_rates</span> <span class="kn">import</span> <span class="n">plot_rates_popnet</span>

<span class="n">plot_rates_popnet</span><span class="p">(</span><span class="s1">&#39;sim_ch06/network/V1_node_types.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;sim_ch06/output/firing_rates.csv&#39;</span><span class="p">,</span> <span class="n">model_keys</span><span class="o">=</span><span class="s1">&#39;pop_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/tutorial_population_modeling_18_0.png" src="_images/tutorial_population_modeling_18_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder.html">Building Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators.html">Simulation Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzer.html">Analyzing the Results</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Main Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_NetworkBuilder_Intro.html">Builder: Using the Network Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_cell_clamped.html">BioNet: Single cell with current injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_cell_syn.html">BioNet: Single with with synaptic input</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_single_pop.html">BioNet: Multiple Nodes with single cell-type</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_multi_pop.html">BioNet: Heterogeneous network</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pointnet_modeling.html">PointNet: Point-neuron modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_filter_models.html">FilterNet: Full-field flashing movie</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_auditory_filternet.html">Auditory FilterNet: Generating stimuli from auditory input</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">PopNet: Population-based firing rate models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ad_tutorials.html">Additional Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Networks</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/AllenInstitute/bmtk.git">Github Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshop.html">Annual Modeling Software Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_cite.html">How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="bmtk/bmtk.html">Source Documentation</a></li>
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer">
      
      
      
      <a href="_sources/tutorial_population_modeling.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
<script type="text/javascript" src="_static/external_assets/javascript/portalFooter.js"></script>

  </body>
</html>